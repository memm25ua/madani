---
// import cv from "../../cv.json";
// const { work } = cv;
---

<section id="experience">
    <div class="section-title">
        <h2>Experiencia</h2>
    </div>

    <svg
        id="svg-stage"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 600 1200"
    >
        <path class="line01 line" d="M 10 200 600 200"></path>
        <path class="line02 line" d="M 10 400 600 400"></path>
        <path class="line03 line" d="M 10 600 600 600"></path>
        <path class="line04 line" d="M 10 800 600 800"></path>
        <path class="line05 line" d="M 10 1000 600 1000"></path>
        <text class="text01" x="30" y="190">2018</text>
        <text class="text02" x="30" y="390">2019</text>
        <text class="text03" x="30" y="590">2020</text>

        <path
            class="theLine"
            d="M -5,0
               Q 450 230 300 450
               T 130 750
               Q 100 850 300 1000
               T 150 1200"
            fill="none"
            stroke-width="10px"></path>

        <circle class="ball ball01" r="20" cx="50" cy="100"></circle>
        <circle class="ball ball02" r="20" cx="278" cy="201"></circle>
        <circle class="ball ball03" r="20" cx="327" cy="401"></circle>
        <circle class="ball ball04" r="20" cx="203" cy="601"></circle>
    </svg>
    <div class="timeline">
        <div class="timeline-item">
            <div class="timeline-content">
                <h3>Desarrollador de Backend</h3>
                <p class="company">Entidad Bancaria</p>
                <p class="date">2025 - Presente</p>
                <p>
                    Desarrollo de backend en el sector bancario, utilizando Java
                    y Spring Boot dentro de una arquitectura de microservicios.
                </p>
            </div>
        </div>
        <div class="timeline-item">
            <div class="timeline-content">
                <h3>Desarrollador Full Stack</h3>
                <p class="company">Freelance</p>
                <p class="date">2023 - Presente</p>
                <p>
                    Desarrollo de aplicaciones a medida, desde el concepto
                    inicial hasta el despliegue en producción, y creación de
                    tiendas online con Shopify.
                </p>
            </div>
        </div>
        <div class="timeline-item">
            <div class="timeline-content">
                <h3>Desarrollador Full Stack (Angular/Java)</h3>
                <p class="company">Apps Square S.L.</p>
                <p class="date">2022 - 2025</p>
                <p>
                    Mantenimiento y desarrollo de una aplicación CRM integrada
                    con Trello y Jira, con enfoque en el frontend. Colaboración
                    con diseñadores y aplicación de testing automatizado.
                </p>
            </div>
        </div>
    </div>
</section>

<style>
    #experience {
        padding: 10em 2em;
        background-color: #000;
        color: #fff;
    }

    .section-title {
        width: 75%;
        margin: 0 auto 4em auto;
        text-align: left;
    }

    .section-title h2 {
        font-size: clamp(2rem, 5vw, 4rem);
        text-transform: uppercase;
        font-weight: 500;
        margin: 0;
    }

    .timeline {
        position: relative;
        max-width: 800px;
        margin: 0 auto;
    }

    .timeline::after {
        content: "";
        position: absolute;
        width: 2px;
        background-color: #222;
        top: 0;
        bottom: 0;
        left: 50%;
        margin-left: -1px;
    }

    .timeline-item {
        padding: 1em 2em;
        position: relative;
        width: 50%;
    }

    .timeline-item:nth-child(odd) {
        left: 0;
        padding-left: 0;
    }

    .timeline-item:nth-child(even) {
        left: 50%;
        padding-right: 0;
    }

    .timeline-item::after {
        content: "";
        position: absolute;
        width: 16px;
        height: 16px;
        right: -8px;
        background-color: #fff;
        border: 2px solid #222;
        top: 1.5em;
        border-radius: 50%;
        z-index: 1;
    }

    .timeline-item:nth-child(even)::after {
        left: -8px;
    }

    .timeline-content {
        padding: 1.5em;
        background-color: #111;
        border-radius: 0.5em;
    }

    .timeline-content h3 {
        margin-top: 0;
    }

    .company {
        font-weight: bold;
    }

    .date {
        font-size: 0.9em;
        color: #888;
    }

    ul {
        padding-left: 1.2em;
    }

    @media (max-width: 768px) {
        .timeline::after {
            left: 20px;
        }

        .timeline-item {
            width: 100%;
            padding-left: 50px;
            padding-right: 10px;
        }

        .timeline-item:nth-child(odd) {
            left: 0;
        }

        .timeline-item:nth-child(even) {
            left: 0;
        }

        .timeline-item::after {
            left: 12px;
        }
    }

    #svg-stage {
        max-width: 600px;
        overflow: visible;
        margin-top: 60vh;
    }

    .ball {
        fill: #fff;
        visibility: hidden;
    }

    .line {
        fill: none;
        stroke: #fff;
        stroke-width: 2px;
    }

    text {
        fill: #fff;
        font-size: 15px;
        visibility: hidden;
    }

    .theLine {
        stroke: #fff;
    }
</style>

<script>
    import { gsap } from "gsap";
    import { ScrollTrigger, DrawSVGPlugin, MotionPathPlugin } from "gsap/all";

    gsap.registerPlugin(ScrollTrigger, DrawSVGPlugin, MotionPathPlugin);
    //gsap.defaults({ ease: "none" });

    const pulses = gsap
        .timeline({
            defaults: {
                duration: 0.05,
                autoAlpha: 1,
                scale: 2,
                transformOrigin: "center",
                ease: "elastic(2.5, 1)",
            },
        })
        .to(".ball02, .text01", {}, 0.2)
        .to(".ball03, .text02", {}, 0.33)
        .to(".ball04, .text03", {}, 0.46);

    const main = gsap
        .timeline({
            defaults: { duration: 1, ease: "none" },
            scrollTrigger: {
                trigger: "#svg-stage",
                scrub: true,
                start: "top center",
                end: "bottom center",
            },
        })
        .to(".ball01", { duration: 0.01, autoAlpha: 1 })
        .from(".theLine", { drawSVG: 0 }, 0)
        .to(
            ".ball01",
            {
                motionPath: {
                    path: ".theLine",
                    align: ".theLine",
                    alignOrigin: [0.5, 0.5],
                },
            },
            0,
        )
        .add(pulses, 0);
</script>
